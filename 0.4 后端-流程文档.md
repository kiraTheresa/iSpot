# pre

GPTä½¿ç”¨äº†æ¨¡æ‹Ÿæ•°æ®åº“å¤„ç†æ•°æ®éœ€æ±‚ï¼Œå®é™…å¼€å‘ä¸­ä½¿ç”¨ConcurrentHashMapæˆ–æ•°æ®åº“è¯·è‡ªè¡Œé€‰æ‹©ã€‚



éå¸¸å¥½ âœ… Theresaã€‚ä»¥ä¸‹æ˜¯ `0.4 åç«¯-æµç¨‹æ–‡æ¡£.md`ï¼Œä¸º**é¡¹ç›®åç«¯è´Ÿè´£äºº**ç¼–å†™çš„å®Œæ•´å¼€å‘æµç¨‹æ–‡æ¡£ã€‚

> è¯´æ˜ï¼šå‡è®¾æœ¬é¡¹ç›®åç«¯é‡‡ç”¨ **Spring Boot + RESTful API + å†…å­˜æ•°æ®ç»“æ„ï¼ˆConcurrentHashMapï¼‰** å¼€å‘æ¨¡å¼ï¼Œæš‚ä¸ä½¿ç”¨æ•°æ®åº“ï¼ˆç¬¦åˆæ•™å­¦é˜¶æ®µè¦æ±‚ï¼‰ï¼Œ
>  å¹¶é…åˆå®‰å“ç«¯ï¼ˆç”¨æˆ·/ç¤¾äº¤ã€åœ°å›¾åŠŸèƒ½ï¼‰è¿›è¡Œæ¥å£è”è°ƒã€‚

------

# 0.4 åç«¯ - å¼€å‘æµç¨‹æ–‡æ¡£

## ğŸ§© ä¸€ã€æ€»ä½“è¯´æ˜

### å¼€å‘ç¯å¢ƒ

| é¡¹ç›®é¡¹   | è¯´æ˜                                               |
| -------- | -------------------------------------------------- |
| å¼€å‘æ¡†æ¶ | Spring Boot 3.x                                    |
| æ„å»ºå·¥å…· | Maven                                              |
| è¿è¡Œç¯å¢ƒ | JDK 17+                                            |
| å­˜å‚¨æ–¹å¼ | å†…å­˜ï¼ˆConcurrentHashMapï¼‰ï¼Œæ— éœ€æ•°æ®åº“              |
| API é£æ ¼ | RESTful                                            |
| ä¾èµ–ç®¡ç† | Spring Boot Starter Webã€Lombokã€Spring Validation |
| æµ‹è¯•å·¥å…· | Postman / Apifox / cURL                            |
| è¾“å‡ºæ ¼å¼ | JSON                                               |

------

## ğŸ§­ äºŒã€é˜¶æ®µåˆ’åˆ†æ¦‚è§ˆ

| é˜¶æ®µ   | å†…å®¹                       | ç›®æ ‡                                |
| ------ | -------------------------- | ----------------------------------- |
| é˜¶æ®µ 0 | é¡¹ç›®åˆå§‹åŒ–ä¸ç»“æ„è§„åˆ’       | åˆ›å»ºæ ‡å‡†åŒ– Spring Boot åç«¯ç»“æ„     |
| é˜¶æ®µ 1 | å®ä½“ä¸ä»“åº“å±‚ï¼ˆRepositoryï¼‰ | å»ºç«‹å†…å­˜å­˜å‚¨é€»è¾‘                    |
| é˜¶æ®µ 2 | ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆServiceï¼‰      | å®ç°ä¸šåŠ¡è§„åˆ™ä¸æ•°æ®æµè½¬              |
| é˜¶æ®µ 3 | æ§åˆ¶å±‚ï¼ˆControllerï¼‰       | æä¾› REST æ¥å£                      |
| é˜¶æ®µ 4 | æ•°æ®äº¤äº’ä¸è”è°ƒ             | ä¸ Android å®¢æˆ·ç«¯ API å¯¹æ¥          |
| é˜¶æ®µ 5 | æµ‹è¯•ä¸éƒ¨ç½²                 | ä½¿ç”¨ Postman è¿›è¡Œæ¥å£æµ‹è¯•ä¸æ–‡æ¡£å®Œå–„ |

------

## âš™ï¸ ä¸‰ã€é˜¶æ®µ 0ï¼šé¡¹ç›®åˆå§‹åŒ–ä¸ç»“æ„è§„åˆ’

### 1. åˆ›å»ºå·¥ç¨‹

åœ¨ IntelliJ IDEA æˆ– Eclipse ä¸­æ–°å»ºï¼š

```
spring-boot-backend/
 â”œâ”€ src/
 â”‚   â”œâ”€ main/
 â”‚   â”‚   â”œâ”€ java/com/example/backend/
 â”‚   â”‚   â”‚   â”œâ”€ controller/
 â”‚   â”‚   â”‚   â”œâ”€ service/
 â”‚   â”‚   â”‚   â”œâ”€ repository/
 â”‚   â”‚   â”‚   â””â”€ model/
 â”‚   â”‚   â””â”€ resources/
 â”‚   â”‚       â””â”€ application.yml
 â”‚   â””â”€ test/
 â””â”€ pom.xml
```

### 2. pom.xml åŸºæœ¬ä¾èµ–

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <optional>true</optional>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
</dependencies>
```

------

## ğŸ§± å››ã€é˜¶æ®µ 1ï¼šå®ä½“ç±»ä¸æ•°æ®è®¿é—®å±‚ï¼ˆRepositoryï¼‰

### 1. æ•°æ®æ¨¡å‹è®¾è®¡

å‚è€ƒå‰æœŸæ•°æ®æ¨¡å‹æ–‡æ¡£ï¼Œå¦‚ï¼š

- `User`ï¼ˆç”¨æˆ·ï¼‰
- `Post`ï¼ˆåŠ¨æ€ï¼‰
- `LocationPoint`ï¼ˆä½ç½®ç‚¹ï¼‰

ç¤ºä¾‹ï¼ˆUserï¼‰ï¼š

```java
@Data
public class User {
    private String id;        // UUID
    private String username;  // ç”¨æˆ·å
    private String password;  // å¯†ç ï¼ˆç®€å•å­˜å‚¨ï¼‰
    private String nickname;  // æ˜¾ç¤ºå
    private double lat;       // å½“å‰çº¬åº¦
    private double lng;       // å½“å‰ç»åº¦
}
```

### 2. å†…å­˜ä»“åº“å®ç°

```java
@Repository
public class UserRepository {
    private final Map<String, User> users = new ConcurrentHashMap<>();

    public List<User> findAll() {
        return new ArrayList<>(users.values());
    }

    public Optional<User> findById(String id) {
        return Optional.ofNullable(users.get(id));
    }

    public void save(User user) {
        users.put(user.getId(), user);
    }

    public void delete(String id) {
        users.remove(id);
    }
}
```

------

## ğŸ§© äº”ã€é˜¶æ®µ 2ï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼ˆServiceï¼‰

å®ç°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æ³¨å†Œã€ç™»å½•ã€ä½ç½®ä¸Šä¼ ã€å¥½å‹æŸ¥è¯¢ç­‰ã€‚

```java
@Service
public class UserService {
    @Autowired
    private UserRepository repo;

    public User register(User user) {
        user.setId(UUID.randomUUID().toString());
        repo.save(user);
        return user;
    }

    public User login(String username, String password) {
        return repo.findAll().stream()
                .filter(u -> u.getUsername().equals(username) && u.getPassword().equals(password))
                .findFirst()
                .orElseThrow(() -> new RuntimeException("Invalid credentials"));
    }

    public void updateLocation(String id, double lat, double lng) {
        User user = repo.findById(id).orElseThrow();
        user.setLat(lat);
        user.setLng(lng);
        repo.save(user);
    }
}
```

------

## ğŸŒ å…­ã€é˜¶æ®µ 3ï¼šæ§åˆ¶å±‚ï¼ˆControllerï¼‰

å®ç° RESTful API æ¥å£ã€‚

```java
@RestController
@RequestMapping("/api/user")
public class UserController {

    @Autowired
    private UserService service;

    @PostMapping("/register")
    public User register(@RequestBody User user) {
        return service.register(user);
    }

    @PostMapping("/login")
    public User login(@RequestBody Map<String, String> body) {
        return service.login(body.get("username"), body.get("password"));
    }

    @PostMapping("/{id}/location")
    public ResponseEntity<?> updateLocation(@PathVariable String id, @RequestBody Map<String, Double> body) {
        service.updateLocation(id, body.get("lat"), body.get("lng"));
        return ResponseEntity.ok("Location updated");
    }

    @GetMapping("/all")
    public List<User> allUsers() {
        return service.getAllUsers();
    }
}
```

------

## ğŸ”„ ä¸ƒã€é˜¶æ®µ 4ï¼šä¸å®‰å“ç«¯çš„æ¥å£è”è°ƒ

| åŠŸèƒ½         | è¯·æ±‚ç±»å‹ | è·¯å¾„                      | è¯·æ±‚ä½“                           | å“åº”     |
| ------------ | -------- | ------------------------- | -------------------------------- | -------- |
| ç”¨æˆ·æ³¨å†Œ     | POST     | `/api/user/register`      | `{username, password, nickname}` | ç”¨æˆ·å¯¹è±¡ |
| ç™»å½•         | POST     | `/api/user/login`         | `{username, password}`           | ç”¨æˆ·å¯¹è±¡ |
| æ›´æ–°ä½ç½®     | POST     | `/api/user/{id}/location` | `{lat, lng}`                     | OK       |
| è·å–å…¨éƒ¨ç”¨æˆ· | GET      | `/api/user/all`           | -                                | ç”¨æˆ·æ•°ç»„ |

> åœ°å›¾å¼€å‘äººå‘˜å¯ä½¿ç”¨ `/all` è·å–æ‰€æœ‰ç”¨æˆ·åæ ‡ç‚¹ï¼Œåœ¨åœ°å›¾ä¸Šç»˜åˆ¶å¥½å‹ä½ç½®ã€‚
>  ç¤¾äº¤æ¨¡å—å¼€å‘äººå‘˜å¯é€šè¿‡ `register/login` å®ç°è´¦å·ä½“ç³»ã€‚

------

## ğŸ§ª å…«ã€é˜¶æ®µ 5ï¼šæµ‹è¯•ä¸éƒ¨ç½²

### 1. ä½¿ç”¨ Postman / Apifox æµ‹è¯•æ¥å£

æµ‹è¯•æµç¨‹ï¼š

1. æ³¨å†Œ â†’ ç™»å½• â†’ æ›´æ–°ä½ç½®
2. è·å–å…¨éƒ¨ç”¨æˆ· â†’ éªŒè¯åæ ‡åŒæ­¥

### 2. æœ¬åœ°éƒ¨ç½²

è¿è¡Œï¼š

```bash
mvn spring-boot:run
```

é»˜è®¤ç«¯å£ï¼š`http://localhost:8080`

### 3. éƒ¨ç½²æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰

- ä½¿ç”¨ `ngrok` æš´éœ²æœ¬åœ°æ¥å£ä¾›å®‰å“ç«¯è®¿é—®ï¼›
- æˆ–éƒ¨ç½²è‡³äº‘æœåŠ¡å™¨ï¼ˆå¦‚é˜¿é‡Œäº‘ã€Vercelã€Renderï¼‰ã€‚

------

## ğŸ“˜ ä¹ã€åç»­æ‰©å±•å»ºè®®

| æ¨¡å—     | å‡çº§æ–¹å‘                                     |
| -------- | -------------------------------------------- |
| æ•°æ®å­˜å‚¨ | ä»å†…å­˜ç»“æ„è¿ç§»è‡³æ•°æ®åº“ï¼ˆMySQL / PostgreSQLï¼‰ |
| å®‰å…¨æ€§   | å¢åŠ  JWT ç™»å½•é‰´æƒ                            |
| æ€§èƒ½     | å¢åŠ ç¼“å­˜å±‚ï¼ˆå¦‚ Redisï¼‰                       |
| æ–‡æ¡£     | ä½¿ç”¨ Swagger/OpenAPI è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£            |

------

## âœ… ç»“è¯­

åç«¯è´Ÿè´£äººéœ€ä¿è¯æ¥å£çš„**ç¨³å®šæ€§ä¸ä¸€è‡´æ€§**ï¼Œ
 ä¸ºå‰ç«¯ï¼ˆå®‰å“ç”¨æˆ·æ¨¡å—ã€åœ°å›¾æ¨¡å—ï¼‰æä¾›ç»Ÿä¸€æ•°æ®æ”¯æŒã€‚
 å»ºè®®æå‰å®šä¹‰æ¥å£æ–‡æ¡£å¹¶å»ºç«‹æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿å„æ¨¡å—åä½œé¡ºç•…ã€‚

------

æ˜¯å¦å¸Œæœ›æˆ‘æ¥ç€è¾“å‡º `0.1 åç«¯è´Ÿè´£äººæ¥å£æ–‡æ¡£`ï¼ˆå³ä¸å®‰å“ç«¯å¯¹åº”çš„è¯¦ç»† API è¯´æ˜è¡¨ï¼‰ï¼Ÿ
 é‚£ä»½æ–‡æ¡£ä¼šæŠŠæ‰€æœ‰æ¥å£å­—æ®µã€è¯·æ±‚ç¤ºä¾‹ã€å“åº”ç¤ºä¾‹éƒ½åˆ—æ¸…æ¥šï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œã€‚